<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Cache-busting headers -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <title>LuxeMarket - Premium Shopping Experience</title>
    <meta name="description" content="Discover premium products at LuxeMarket. Shop the latest trends in fashion, electronics, and more.">
    <link rel="icon" type="image/png" href="favicon.ico">

    <script src="https://resource.trickle.so/vendor_lib/unpkg/react@18/umd/react.production.min.js"></script>
    <script src="https://resource.trickle.so/vendor_lib/unpkg/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://resource.trickle.so/vendor_lib/unpkg/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://resource.trickle.so/vendor_lib/unpkg/lucide-static@0.516.0/font/lucide.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style type="text/tailwindcss">
        @layer theme {
        :root {
            --primary-color: #2563EB;
            --primary-hover: #1D4ED8;
            --secondary-color: #F3F4F6;
            --text-main: #111827;
            --text-muted: #6B7280;
            --bg-body: #FFFFFF;
            --accent-color: #F59E0B;
        }
    }

    @layer base {
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
        }
    }

    @layer components {
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-weight: 500;
            transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
            transition-duration: 200ms;
        }
        .btn:focus {
            outline: 2px solid transparent;
            outline-offset: 2px;
            box-shadow: 0 0 0 2px #fff, 0 0 0 4px currentColor;
        }
        .btn-primary {
            background-color: var(--primary-color);
            color: #ffffff;
            border: 1px solid transparent;
        }
        .btn-primary:hover {
            background-color: var(--primary-hover);
        }
        .btn-primary:focus {
            box-shadow: 0 0 0 2px #fff, 0 0 0 4px var(--primary-color);
        }
        .btn-secondary {
            background-color: #ffffff;
            border: 1px solid #d1d5db;
            color: #374151;
        }
        .btn-secondary:hover {
            background-color: #f9fafb;
        }
        .btn-secondary:focus {
            box-shadow: 0 0 0 2px #fff, 0 0 0 4px #6b7280;
        }
        .container-custom {
            max-width: 80rem;
            margin-left: auto;
            margin-right: auto;
            padding-left: 1rem;
            padding-right: 1rem;
        }
        @media (min-width: 640px) {
            .container-custom { padding-left: 1.5rem; padding-right: 1.5rem; }
        }
        @media (min-width: 1024px) {
            .container-custom { padding-left: 2rem; padding-right: 2rem; }
        }
        .card {
            background-color: #ffffff;
            border-radius: 0.75rem;
            border: 1px solid #f3f4f6;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
            transition: all 300ms cubic-bezier(0.4, 0, 0.2, 1);
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
    }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        // ProductManager
        const INITIAL_PRODUCTS = [];
        const INITIAL_CATEGORIES = ["Electronics", "Fashion", "Furniture", "Accessories", "Sporting Goods", "Industrial", "Motors", "Deals"];
        const PRODUCT_STORAGE_KEY = 'luxemarket_products';
        const CATEGORY_STORAGE_KEY = 'luxemarket_categories';
        const CURRENT_DATA_VERSION = 'v1.9';

        const ProductManager = {
            _initialized: false,
            
            init: () => {
                if (ProductManager._initialized) return;
                
                const storedVersion = localStorage.getItem('luxemarket_data_version');
                const urlParams = new URLSearchParams(window.location.search);
                const forceReset = urlParams.get('reset') === 'true' || urlParams.get('v') === '1.8';
                
                if (!localStorage.getItem(PRODUCT_STORAGE_KEY) || storedVersion !== CURRENT_DATA_VERSION || forceReset) {
                    localStorage.setItem(PRODUCT_STORAGE_KEY, JSON.stringify(INITIAL_PRODUCTS));
                    localStorage.setItem(CATEGORY_STORAGE_KEY, JSON.stringify(INITIAL_CATEGORIES));
                    localStorage.setItem('luxemarket_data_version', CURRENT_DATA_VERSION);
                    
                    if (forceReset && window.history && window.history.replaceState) {
                        const newUrl = window.location.pathname + window.location.hash;
                        window.history.replaceState({}, document.title, newUrl);
                    }
                }
                
                ProductManager._initialized = true;
            },

            getAll: () => {
                ProductManager.init();
                try {
                    const raw = localStorage.getItem(PRODUCT_STORAGE_KEY);
                    return JSON.parse(raw) || [];
                } catch (e) {
                    return [];
                }
            }
        };

        window.ProductManager = ProductManager;

        // Toast Context
        const ToastContext = React.createContext();

        function useToast() {
            const context = React.useContext(ToastContext);
            if (!context) {
                return { addToast: () => {} };
            }
            return context;
        }

        function ToastProvider({ children }) {
            const [toasts, setToasts] = React.useState([]);

            const addToast = (message, type = 'success') => {
                const id = Date.now();
                setToasts(prev => [...prev, { id, message, type }]);
                setTimeout(() => {
                    setToasts(prev => prev.filter(toast => toast.id !== id));
                }, 3000);
            };

            return (
                <ToastContext.Provider value={{ addToast }}>
                    {children}
                    <div className="fixed top-4 right-4 z-50 space-y-2">
                        {toasts.map(toast => (
                            <div key={toast.id} className={`p-4 rounded-lg shadow-lg ${toast.type === 'success' ? 'bg-green-500 text-white' : 'bg-blue-500 text-white'}`}>
                                {toast.message}
                            </div>
                        ))}
                    </div>
                </ToastContext.Provider>
            );
        }

        // Header Component
        function Header() {
            const [cartCount, setCartCount] = React.useState(0);

            return (
                <header className="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-40">
                    <div className="container-custom">
                        <div className="flex justify-between items-center h-16">
                            <div className="flex items-center">
                                <h1 className="text-2xl font-bold text-gray-900">LuxeMarket</h1>
                            </div>
                            <div className="flex items-center space-x-4">
                                <button 
                                    onClick={() => window.open('simple-test.html', '_blank')}
                                    className="btn btn-secondary text-sm"
                                >
                                    Add Products
                                </button>
                                <button 
                                    onClick={() => window.open('admin.html', '_blank')}
                                    className="btn btn-primary text-sm"
                                >
                                    Admin
                                </button>
                                <button className="btn btn-secondary">
                                    Cart ({cartCount})
                                </button>
                            </div>
                        </div>
                    </div>
                </header>
            );
        }

        // Hero Component
        function Hero() {
            const { addToast } = useToast();

            return (
                <section className="relative bg-gradient-to-r from-blue-600 to-purple-600 text-white py-20">
                    <div className="container-custom">
                        <div className="text-center">
                            <h1 className="text-4xl md:text-6xl font-bold mb-6">
                                Elevate Your Style With Premium Essentials
                            </h1>
                            <p className="text-xl mb-8 max-w-2xl mx-auto">
                                Discover our curated collection of high-quality products designed to enhance your lifestyle with enhanced size selection.
                            </p>
                            <div className="flex flex-col sm:flex-row gap-4 justify-center">
                                <a href="#featured-products" className="btn btn-primary bg-white text-blue-600 hover:bg-gray-100 px-8 py-3 text-lg">
                                    Shop Now
                                </a>
                                <button 
                                    onClick={() => addToast('Collections feature coming soon!', 'info')}
                                    className="btn btn-secondary border-white text-white hover:bg-white hover:text-blue-600 px-8 py-3 text-lg"
                                >
                                    View Collections
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
            );
        }

        // Product Card Component
        function ProductCard({ product }) {
            const handleClick = () => {
                window.open(`product.html?id=${product.id}`, '_blank');
            };

            return (
                <div className="card cursor-pointer" onClick={handleClick}>
                    <div className="aspect-w-1 aspect-h-1 bg-gray-200 rounded-t-lg overflow-hidden">
                        <img 
                            src={product.image} 
                            alt={product.name}
                            className="w-full h-48 object-cover"
                            onError={(e) => { e.target.src = 'https://via.placeholder.com/300x200?text=No+Image'; }}
                        />
                    </div>
                    <div className="p-6">
                        <h3 className="text-lg font-semibold text-gray-900 mb-2">{product.name}</h3>
                        <p className="text-gray-600 text-sm mb-2">{product.category}</p>
                        <div className="flex justify-between items-center mb-3">
                            <span className="text-2xl font-bold text-gray-900">${product.price}</span>
                            <div className="flex items-center">
                                <div className="flex text-yellow-400 text-sm">
                                    {[...Array(5)].map((_, i) => (
                                        <div key={i} className={`icon-star ${i < Math.floor(product.rating || 4.5) ? 'fill-current' : 'text-gray-300'}`}></div>
                                    ))}
                                </div>
                                <span className="text-sm text-gray-500 ml-1">({product.reviews || 0})</span>
                            </div>
                        </div>
                        
                        {product.sizes && product.sizes.length > 0 && (
                            <div className="mb-2">
                                <span className="text-sm text-blue-600 font-medium">
                                    Sizes: {product.sizes.slice(0, 4).join(', ')}{product.sizes.length > 4 ? '...' : ''}
                                </span>
                            </div>
                        )}
                        
                        {product.colors && product.colors.length > 0 && (
                            <div className="flex items-center">
                                <span className="text-sm text-gray-500 mr-2">Colors:</span>
                                <div className="flex space-x-1">
                                    {product.colors.slice(0, 4).map((color, index) => (
                                        <div 
                                            key={index}
                                            className="w-4 h-4 rounded-full border border-gray-300"
                                            style={{ backgroundColor: color.hex }}
                                            title={color.name}
                                        ></div>
                                    ))}
                                    {product.colors.length > 4 && (
                                        <span className="text-xs text-gray-400">+{product.colors.length - 4}</span>
                                    )}
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // Featured Products Component
        function FeaturedProducts() {
            const [products, setProducts] = React.useState([]);

            React.useEffect(() => {
                const allProducts = ProductManager.getAll();
                setProducts(allProducts);
            }, []);

            return (
                <section id="featured-products" className="py-16 bg-gray-50">
                    <div className="container-custom">
                        <div className="text-center mb-12">
                            <h2 className="text-3xl font-bold text-gray-900 mb-4">Featured Products</h2>
                            <p className="text-gray-600 max-w-2xl mx-auto">
                                {products.length === 0 
                                    ? "No products yet. Use the 'Add Products' button to get started and test the enhanced size selection!"
                                    : `Discover our ${products.length} premium products with enhanced size selection features`
                                }
                            </p>
                        </div>

                        {products.length === 0 ? (
                            <div className="text-center py-12">
                                <div className="bg-white rounded-lg shadow-md p-8 max-w-md mx-auto">
                                    <div className="text-6xl mb-4">üõçÔ∏è</div>
                                    <h3 className="text-xl font-semibold text-gray-900 mb-2">No Products Yet</h3>
                                    <p className="text-gray-600 mb-4">Add some products to see the enhanced size selection in action!</p>
                                    <button 
                                        onClick={() => window.open('simple-test.html', '_blank')}
                                        className="btn btn-primary"
                                    >
                                        Add Test Products
                                    </button>
                                </div>
                            </div>
                        ) : (
                            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                                {products.map(product => (
                                    <ProductCard key={product.id} product={product} />
                                ))}
                            </div>
                        )}
                    </div>
                </section>
            );
        }

        // Footer Component
        function Footer() {
            return (
                <footer className="bg-gray-900 text-white py-12">
                    <div className="container-custom">
                        <div className="text-center">
                            <h3 className="text-2xl font-bold mb-4">LuxeMarket</h3>
                            <p className="text-gray-400 mb-6">Premium shopping experience with enhanced size selection</p>
                            <p className="text-gray-500">&copy; 2026 LuxeMarket. All rights reserved.</p>
                        </div>
                    </div>
                </footer>
            );
        }

        // Main App Component
        function App() {
            return (
                <ToastProvider>
                    <div className="min-h-screen bg-white">
                        <Header />
                        <Hero />
                        <FeaturedProducts />
                        <Footer />
                    </div>
                </ToastProvider>
            );
        }

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>