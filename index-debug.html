<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Index Debug - LuxeMarket</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-4">
    <div class="max-w-4xl mx-auto bg-white rounded-lg shadow p-6">
        <h1 class="text-2xl font-bold mb-4">Index.html Debug</h1>
        <div id="debug-log" class="space-y-2 text-sm font-mono bg-gray-50 p-4 rounded"></div>
        <div id="root" class="mt-6"></div>
    </div>

    <script>
        function log(message) {
            console.log(message);
            const debugLog = document.getElementById('debug-log');
            debugLog.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + message + '</div>';
        }

        log('1. Starting debug...');

        // Test React loading
        log('2. Loading React...');
    </script>

    <!-- React Scripts -->
    <script src="https://resource.trickle.so/vendor_lib/unpkg/react@18/umd/react.production.min.js"></script>
    <script src="https://resource.trickle.so/vendor_lib/unpkg/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://resource.trickle.so/vendor_lib/unpkg/@babel/standalone/babel.min.js"></script>

    <script>
        log('3. React loaded: ' + (typeof React !== 'undefined' ? 'YES' : 'NO'));
        log('4. ReactDOM loaded: ' + (typeof ReactDOM !== 'undefined' ? 'YES' : 'NO'));
        log('5. Babel loaded: ' + (typeof Babel !== 'undefined' ? 'YES' : 'NO'));
    </script>

    <!-- Test data.js loading -->
    <script type="text/babel">
        log('6. Babel is working - JSX can be processed');
        
        // Inline ProductManager for testing
        const INITIAL_PRODUCTS = [];
        const PRODUCT_STORAGE_KEY = 'luxemarket_products';
        const CURRENT_DATA_VERSION = 'v1.9';

        const ProductManager = {
            _initialized: false,
            
            init: () => {
                if (ProductManager._initialized) return;
                
                const storedVersion = localStorage.getItem('luxemarket_data_version');
                const urlParams = new URLSearchParams(window.location.search);
                const forceReset = urlParams.get('reset') === 'true' || urlParams.get('v') === '1.8';
                
                if (!localStorage.getItem(PRODUCT_STORAGE_KEY) || storedVersion !== CURRENT_DATA_VERSION || forceReset) {
                    localStorage.setItem(PRODUCT_STORAGE_KEY, JSON.stringify(INITIAL_PRODUCTS));
                    localStorage.setItem('luxemarket_data_version', CURRENT_DATA_VERSION);
                    
                    if (forceReset && window.history && window.history.replaceState) {
                        const newUrl = window.location.pathname + window.location.hash;
                        window.history.replaceState({}, document.title, newUrl);
                    }
                }
                
                ProductManager._initialized = true;
            },

            getAll: () => {
                ProductManager.init();
                try {
                    const raw = localStorage.getItem(PRODUCT_STORAGE_KEY);
                    return JSON.parse(raw) || [];
                } catch (e) {
                    return [];
                }
            }
        };

        window.ProductManager = ProductManager;
        log('7. ProductManager created');

        // Simple test component
        function TestApp() {
            const [products, setProducts] = React.useState([]);
            const [loading, setLoading] = React.useState(true);

            React.useEffect(() => {
                try {
                    log('8. Loading products...');
                    const allProducts = ProductManager.getAll();
                    setProducts(allProducts);
                    log('9. Products loaded: ' + allProducts.length);
                    setLoading(false);
                } catch (error) {
                    log('9. ERROR loading products: ' + error.message);
                    setLoading(false);
                }
            }, []);

            if (loading) {
                return React.createElement('div', { className: 'text-center p-4' }, 'Loading...');
            }

            return React.createElement('div', { className: 'text-center p-4' },
                React.createElement('h2', { className: 'text-xl font-bold mb-2' }, 'Test App Working!'),
                React.createElement('p', { className: 'text-gray-600' }, `Found ${products.length} products`),
                React.createElement('div', { className: 'mt-4 space-x-2' },
                    React.createElement('button', {
                        onClick: () => window.open('simple-test.html', '_blank'),
                        className: 'bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600'
                    }, 'Add Products'),
                    React.createElement('button', {
                        onClick: () => window.open('admin.html', '_blank'),
                        className: 'bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600'
                    }, 'Admin Panel')
                )
            );
        }

        log('10. Rendering test app...');
        
        try {
            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(React.createElement(TestApp));
            log('11. SUCCESS - App rendered!');
        } catch (error) {
            log('11. ERROR rendering app: ' + error.message);
        }
    </script>
</body>
</html>