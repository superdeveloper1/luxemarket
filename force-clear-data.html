<!DOCTYPE html>
<html>
<head>
    <title>Force Clear LuxeMarket Data</title>
    <style>
        body { 
            font-family: Arial; 
            padding: 20px; 
            background: #f0f0f0;
            max-width: 800px;
            margin: 0 auto;
        }
        .section { 
            background: white; 
            padding: 20px; 
            margin: 15px 0; 
            border-radius: 8px; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button { 
            padding: 12px 20px; 
            margin: 8px; 
            background: #007cba; 
            color: white; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            font-size: 14px;
        }
        button:hover { background: #005a87; }
        .danger { background: #dc3545; }
        .danger:hover { background: #c82333; }
        .success { background: #28a745; }
        .success:hover { background: #218838; }
        .info { color: #0066cc; font-weight: bold; }
        .warning { color: #ff6600; font-weight: bold; }
        .error { color: #cc0000; font-weight: bold; }
        pre { 
            background: #f8f9fa; 
            padding: 10px; 
            border-radius: 4px; 
            overflow-x: auto;
            font-size: 12px;
        }
        .product-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
            padding: 10px;
            margin: 10px 0;
        }
        .product-item {
            padding: 5px;
            border-bottom: 1px solid #eee;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <h1>üîß LuxeMarket Data Management</h1>
    
    <div class="section">
        <h3>Current Data Status</h3>
        <p><strong>Data Version:</strong> <span id="dataVersion">Loading...</span></p>
        <p><strong>Products in Storage:</strong> <span id="productCount">Loading...</span></p>
        <p><strong>Storage Size:</strong> <span id="storageSize">Loading...</span></p>
        <button onclick="checkCurrentData()">üîÑ Refresh Status</button>
    </div>
    
    <div class="section">
        <h3>Current Products in Storage</h3>
        <div id="currentProducts" class="product-list">Loading...</div>
    </div>
    
    <div class="section">
        <h3>‚ö†Ô∏è Data Reset Actions</h3>
        <p><strong>Problem:</strong> Your browser is showing old deleted products because they're cached in localStorage.</p>
        <p><strong>Solution:</strong> Clear the cache and force reload fresh data.</p>
        
        <button onclick="clearAllLuxeMarketData()" class="danger">
            üóëÔ∏è Clear ALL LuxeMarket Data
        </button>
        
        <button onclick="forceDataReset()" class="warning" style="background: #ff6600;">
            üîÑ Force Reset to Default Products
        </button>
        
        <button onclick="incrementDataVersion()" class="success">
            ‚¨ÜÔ∏è Increment Data Version (Force Refresh)
        </button>
    </div>
    
    <div class="section">
        <h3>üß™ Test Links</h3>
        <p>After clearing data, test these links:</p>
        <a href="index-portable.html" target="_blank" style="display: inline-block; padding: 10px 15px; background: #007cba; color: white; text-decoration: none; border-radius: 4px; margin: 5px;">
            üõçÔ∏è Test Live Demo
        </a>
        <a href="admin-portable.html" target="_blank" style="display: inline-block; padding: 10px 15px; background: #28a745; color: white; text-decoration: none; border-radius: 4px; margin: 5px;">
            ‚öôÔ∏è Test Admin Panel
        </a>
    </div>
    
    <div id="messages" class="section">
        <h3>üìã Action Log</h3>
        <div id="messageList"></div>
    </div>

    <script>
        function addMessage(msg, type = 'info') {
            const messageList = document.getElementById('messageList');
            const div = document.createElement('div');
            div.className = type;
            div.innerHTML = `<strong>${new Date().toLocaleTimeString()}:</strong> ${msg}`;
            messageList.appendChild(div);
            messageList.scrollTop = messageList.scrollHeight;
        }
        
        function checkCurrentData() {
            const version = localStorage.getItem('luxemarket_data_version') || 'Not set';
            const productsData = localStorage.getItem('luxemarket_products');
            const products = productsData ? JSON.parse(productsData) : [];
            const storageSize = JSON.stringify(localStorage).length;
            
            document.getElementById('dataVersion').textContent = version;
            document.getElementById('productCount').textContent = products.length;
            document.getElementById('storageSize').textContent = (storageSize / 1024).toFixed(2) + ' KB';
            
            // Show current products
            const currentProductsDiv = document.getElementById('currentProducts');
            if (products.length === 0) {
                currentProductsDiv.innerHTML = '<p class="warning">No products found in storage</p>';
            } else {
                currentProductsDiv.innerHTML = products.map((product, index) => 
                    `<div class="product-item">
                        <strong>${index + 1}. ${product.name}</strong> - $${product.price} 
                        <small>(ID: ${product.id}, Category: ${product.category})</small>
                    </div>`
                ).join('');
            }
            
            addMessage(`Data check complete: Version ${version}, ${products.length} products found`);
        }
        
        function clearAllLuxeMarketData() {
            const keys = Object.keys(localStorage);
            let cleared = 0;
            keys.forEach(key => {
                if (key.includes('luxemarket')) {
                    localStorage.removeItem(key);
                    cleared++;
                }
            });
            addMessage(`üóëÔ∏è Cleared ${cleared} LuxeMarket localStorage items`, 'success');
            checkCurrentData();
        }
        
        function forceDataReset() {
            // Clear existing data
            localStorage.removeItem('luxemarket_products');
            localStorage.removeItem('luxemarket_categories');
            localStorage.removeItem('luxemarket_data_version');
            
            addMessage('üîÑ Forced complete data reset - localStorage cleared', 'warning');
            addMessage('‚ÑπÔ∏è Next time you open the app, it will load default products from code', 'info');
            checkCurrentData();
        }
        
        function incrementDataVersion() {
            const currentVersion = localStorage.getItem('luxemarket_data_version') || 'v1.7';
            const versionNumber = parseFloat(currentVersion.replace('v', '')) || 1.7;
            const newVersion = 'v' + (versionNumber + 0.1).toFixed(1);
            
            // Clear data and set new version
            localStorage.removeItem('luxemarket_products');
            localStorage.removeItem('luxemarket_categories');
            localStorage.setItem('luxemarket_data_version', newVersion);
            
            addMessage(`‚¨ÜÔ∏è Incremented data version to ${newVersion} - this will force fresh data load`, 'success');
            checkCurrentData();
        }
        
        // Check data on load
        checkCurrentData();
        addMessage('üöÄ Data management tool loaded', 'info');
    </script>
</body>
</html>